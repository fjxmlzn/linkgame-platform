# linkgame-platform
Matlab course project (linkgame)'s platform

## 支持环境 ##
- windows10、MatlabR2014a测试通过。
- Mac10.10、MatlabR2014b测试通过。

## 该平台与之前李步宇学长的版本的主要区别 ##
1. 增加了一些功能，如设置游戏区域大小，显示所有可消块对等等，详见程序。
1. 游戏方块显示的坐标调整为与用户感知一致（左上角为原点），方便操作。（这个修改对第二题摄像头采集会有影响，但是是变得更方便。）
1. 根据李步宇学长的建议，取消了不友好的按键精灵调用。现在鼠标点击可以在matlab内部无缝衔接，顺便也不再需要管理员权限了。为了保持灵活性，独立出autoClick模块，详见后文。
1. 合并了原来的两道题的平台。  
原来第一题对应的游戏设置为：  
区域大小：7\*12；游戏无法继续进行时：不做任何处理；游戏区域数据来源：内部逻辑；输出模式：完整步骤。  
原来第二题对应的游戏设置为：  
区域大小：7\*12；游戏无法继续进行时：随机交换剩余方块；游戏区域数据来源：摄像头；输出模式：单个步骤。
1. 为了保证大作业的向下兼容，用户接口不变，包括omg、user_camera、ai、detect。

## 各个文件的说明 ##
1. ai.m-用户需要实现的摄像头模式AI。
1. autoClick.m-根据步骤自动点击的模块，类似于本次大作业的按键精灵程序，用户可以修改以支持其他游戏。它需要调用pressMouse模块。
1. bg.jpg-连连看游戏背景图片。用户可以根据喜好更换。
1. construct.m-生成指定大小、指定色数的游戏区域。暂且为最简单的随机生成方式。
1. detect.m-用户需要实现的判断块是否可消。
1. detect.p-detect模块pcode。
1. linkgame.fig-游戏主程序fig。
1. linkgame.m-游戏主程序代码。包含注释。
1. omg.m-用户需要实现的完整步骤外挂。
1. omg.p-omg模块pcode。
1. pics.mat-连连看精灵图片的cell数组。用户可以根据喜好更换。
1. pressMouse.p-调用java实现的鼠标点击模块。
1. user_camera.m-用户可以修改的摄像头数据采集模块。
1. checkActive.m-调用java实现的判断鼠标是否在窗口内的模块。用于停止外挂。

## 用户操作和UI逻辑的简单说明 ##
1. 区域大小：方块行数列数。
1. 游戏无法继续进行时：设置没有可以消去的块时游戏逻辑的处理。
1. 开始新游戏：随时可以开始。点击后将会根据上述设置开始新的游戏，游戏过程中更改上述设置将不会生效。
1. 显示所有可消去块对：随时可以点击。点击后将会弹窗显示所有可消去的块对。
1. 游戏区域数据来源：外挂的数据来源，分别对应了第一题和第二题。
1. 调用模式：  
单次调用-只会调用外挂一次，外挂输出的step删去第一个元素（步骤数量，该元素存在完全是为了兼容现在的版本）后传入autoClick。  
多次调用-当还有可消除的块时，会反复调用外挂，外挂输出的step直接传入autoClock。因此，实际上，在两个模式中，外挂输出的步骤数是任意的。
1. 开启外挂：随时可以开启。点击后会根据上述设置开启外挂，外挂运行期间更改设置不会生效。外挂运行期间无法再次启动。外挂运行过程中可以随时将鼠标移出窗口外以停止外挂。

另外还有一些列提示用户的逻辑存在，比如区域大小的校验、外挂操作指导等。

## 更新日志 ##
2015.9.3 12:43

1. 平台第一版完成。

2015.9.4 14:34

1. 背景图片自动填充游戏区域。
1. 自己实现pressMouse模块。

2015.9.6 22:55

1. 启动外挂时不再将窗口移动，而是直接计算窗口位置并传递到autoClick里。

2015.9.8 19:18

1. 将所有控件的单位统一为pixel，使得在不同分辨率的电脑上都能正确显示，打开窗口时也不会闪烁。
1. 在pressMouse模块鼠标按下和释放之间加上0.1s的延时、在外挂开始前延时1s，保证电脑卡时也能点击正确。

2015.9.13 1:00

1. 更新用户文档，以后版本将保持更新。
1. 为消除歧义，修改用户界面中关于外挂调用方式的提示。同时也对应更新了程序内部控件的Tag。
1. 【重要】将按键盘E停止外挂改为鼠标移到窗口外时停止外挂。以方便停止外挂的操作，防止出现鼠标点击失控的情况。为此增加checkActive模块。
1. 删除了用户接口detect.m和omg.m中关于坐标错位的描述（因为在本平台已经修复了这个问题）。